services:
  mock-tempo:
    build: .
    ports:
      - "8444:8444"
    environment:
      PORT: 8444
      NODE_ENV: production
      # Data generation configuration - must match mock-jira
      NUM_USERS: ${NUM_USERS:-500}
      NUM_TEAMS: ${NUM_TEAMS:-20}
      NUM_ACCOUNTS: ${NUM_ACCOUNTS:-50}
      WORKLOGS_PER_ISSUE_MIN: ${WORKLOGS_PER_ISSUE_MIN:-5}
      WORKLOGS_PER_ISSUE_MAX: ${WORKLOGS_PER_ISSUE_MAX:-20}
      PLANS_PER_USER_MIN: ${PLANS_PER_USER_MIN:-1}
      PLANS_PER_USER_MAX: ${PLANS_PER_USER_MAX:-5}
      # Seed for reproducible data generation - MUST match mock-jira
      DATA_SEED: ${DATA_SEED:-capacity-planner-mock-2024}
      # Date range - must match mock-jira
      START_YEAR: ${START_YEAR:-2022}
      CURRENT_YEAR: ${CURRENT_YEAR:-2026}
    healthcheck:
      test: ["CMD", "wget", "--no-verbose", "--tries=1", "--spider", "http://localhost:8444/health"]
      interval: 10s
      timeout: 5s
      retries: 5
      start_period: 10s
    deploy:
      resources:
        limits:
          memory: 512M
        reservations:
          memory: 256M
    networks:
      - mock-api-net

networks:
  mock-api-net:
    driver: bridge
